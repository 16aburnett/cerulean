// C/C++ style comments
// Author: Amy Burnett
//========================================================================

// You can specify static global info outside of functions
// global variables are denoted by the @ symbol
global @customary_greeting = value (ptr("Hello, World!"))
global @length = value (int32(14))

//========================================================================

function void @print_greeting (ptr(%greeting), int32(%length))
{
label entry
    %i_ptr = alloca (type(int32), int32(1))
    store (ptr(%i_ptr), int32(0), int32(0))
    jmp (label(for_cond))

label for_cond
    %i_curr = load (type(int32), ptr(%i_ptr), int32(0))
    jge (int32(%i_curr), int32(%length), label(for_end))
    jmp (label(for_body))

label for_body
    %char = load (type(char), ptr(%greeting), int32(%i_curr))
    call @__builtin__print__char (char(%char))
    jmp (label(for_update))

label for_update
    %i_next = add (int32(%i_curr), int32(1))
    store (ptr(%i_ptr), int32(0), int32(%i_next))
    jmp (label(for_cond))

label for_end
    call @__builtin__println ()
    return ()
}

//========================================================================

function int32 @main ()
{
label entry
    call @print_greeting (ptr(@customary_greeting), int32(@length))
    return (int32(0))
}
